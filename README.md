# Deno Deps Detective

1. detective _(noun)_

> a person, especially a police officer, whose occupation is to investigate and solve crimes.

Don't let your deno project dependencies become a **crime scene!**

`detective` helps you keep track of your deno dependencies and their versions. It also helps you track important metrics like number of files and total size. It's like a detective for your deno project dependencies. (Last sentence generated by an AI. Brilliant. 😅)

## Installation

```bash
deno install --allow-read --allow-write --allow-net --allow-env --allow-run --unstable https://deno.land/x/detective/detective.ts
```

## Usage

First, create a `deps.json` file using `deno info --json <your_root.ts>`.

```bash
deno info --json ./src/index.ts > deps.json
```

Then, run `detective` with the `deps.json` file as an argument.

```bash
detective deps.json
```

The default mode will show you diagnostics of your dependencies.

You can also use `--json` to output a JSON version of the diagnostics.

```bash
detective --json deps.json
```

## Example

```bash
$ deno info --json ./src/index.ts > deps.json
$ detective deps.json

>>> Userland
┌───────┬───────────────┬──────────┐
│ (idx) │ label         │ value    │
├───────┼───────────────┼──────────┤
│     0 │ "Total size"  │ "470 kB" │
│     1 │ "Total files" │ 200      │
└───────┴───────────────┴──────────┘

>>> Dependencies
┌───────┬───────────────┬───────────┐
│ (idx) │ label         │ value     │
├───────┼───────────────┼───────────┤
│     0 │ "Total size"  │ "4.99 MB" │
│     1 │ "Mean size"   │ "47.5 kB" │
│     2 │ "Median size" │ "4.57 kB" │
│     3 │ "p90 size"    │ "92.4 kB" │
│     4 │ "Max size"    │ "1.19 MB" │
│     5 │ "Total files" │ 1365      │
│     6 │ "Max files"   │ 412       │
│     7 │ "p90 files"   │ 9         │
└───────┴───────────────┴───────────┘

Largest deps (> p90):
┌───────┬──────────────────────────────────┬─────────────┬──────────┬───────┬───────────┐
│ (idx) │ module                           │ bytes       │ size (%) │ files │ files (%) │
├───────┼──────────────────────────────────┼─────────────┼──────────┼───────┼───────────┤
│     0 │ "std@0.170.0"                    │ "1.19 MB"   │ "23.92%" │    87 │ "06.37%"  │
│     1 │ "v96/csstype@3.1.1"              │ "857.89 kB" │ "17.20%" │     1 │ "00.07%"  │
│     2 │ "v102/lodash@4.17.21"            │ "557 kB"    │ "11.17%" │   412 │ "30.18%"  │
│     3 │ "v102/ajv@8.11.2"                │ "349.18 kB" │ "07.00%" │    93 │ "06.81%"  │
│     4 │ "denoflate@1.2.1"                │ "306.6 kB"  │ "06.15%" │     3 │ "00.22%"  │
│     5 │ "esbuild@v0.14.51"               │ "192.33 kB" │ "03.86%" │     4 │ "00.29%"  │
│     6 │ "v102/preact@10.11.3"            │ "135.21 kB" │ "02.71%" │    13 │ "00.95%"  │
│     7 │ "v96/lodash-es@4.17.21"          │ "126.79 kB" │ "02.54%" │   317 │ "23.22%"  │
│     8 │ "v102/@rjsf/utils@5.0.0-beta.15" │ "99.58 kB"  │ "02.00%" │     2 │ "00.15%"  │
│     9 │ "v102/@dnd-kit/core@6.0.5"       │ "93.07 kB"  │ "01.87%" │   114 │ "08.35%"  │
│    10 │ "v102/@rjsf/utils@5.0.0-beta.13" │ "92.42 kB"  │ "01.85%" │     2 │ "00.15%"  │
└───────┴──────────────────────────────────┴─────────────┴──────────┴───────┴───────────┘

Dependencies with most files (> p90):
┌───────┬──────────────────────────────────┬─────────────┬──────────┬───────┬───────────┐
│ (idx) │ module                           │ bytes       │ size (%) │ files │ files (%) │
├───────┼──────────────────────────────────┼─────────────┼──────────┼───────┼───────────┤
│     0 │ "v102/lodash@4.17.21"            │ "557 kB"    │ "11.17%" │   412 │ "30.18%"  │
│     1 │ "v96/lodash-es@4.17.21"          │ "126.79 kB" │ "02.54%" │   317 │ "23.22%"  │
│     2 │ "v102/@dnd-kit/core@6.0.5"       │ "93.07 kB"  │ "01.87%" │   114 │ "08.35%"  │
│     3 │ "v102/ajv@8.11.2"                │ "349.18 kB" │ "07.00%" │    93 │ "06.81%"  │
│     4 │ "std@0.170.0"                    │ "1.19 MB"   │ "23.92%" │    87 │ "06.37%"  │
│     5 │ "v102/@dnd-kit/utilities@3.2.0"  │ "9.18 kB"   │ "00.18%" │    34 │ "02.49%"  │
│     6 │ "tabler_icons_tsx@0.0.2"         │ "17.47 kB"  │ "00.35%" │    30 │ "02.20%"  │
│     7 │ "v102/@dnd-kit/sortable@7.0.1"   │ "16.63 kB"  │ "00.33%" │    28 │ "02.05%"  │
│     8 │ "fresh@1.1.2"                    │ "60.36 kB"  │ "01.21%" │    16 │ "01.17%"  │
│     9 │ "v102/preact@10.11.3"            │ "135.21 kB" │ "02.71%" │    13 │ "00.95%"  │
│    10 │ "v102/@dnd-kit/accessibility@3." │ "1.56 kB"   │ "00.03%" │     9 │ "00.66%"  │
│    11 │ "v102/@supabase/realtime-js@1.7" │ "28.94 kB"  │ "00.58%" │     9 │ "00.66%"  │
│    12 │ "v102/@supabase/storage-js@1.7." │ "19.48 kB"  │ "00.39%" │     9 │ "00.66%"  │
└───────┴──────────────────────────────────┴─────────────┴──────────┴───────┴───────────┘
```
